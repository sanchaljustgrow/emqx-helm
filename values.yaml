replicaCount: 3  # initial cluster size

service:
  type: ClusterIP

clustering:
  strategy: auto
  discovery: k8s
  k8s:
    namespace: default
    serviceName: emqx  # headless service name for cluster discovery

resources:
  limits:
    cpu: 500m
    memory: 512Mi
  requests:
    cpu: 250m
    memory: 256Mi

metrics:
  enabled: true
  serviceMonitor:
    enabled: true

affinity:
  podAntiAffinity:
    requiredDuringSchedulingIgnoredDuringExecution:
      - labelSelector:
          matchLabels:
            app: emqx
        topologyKey: "kubernetes.io/hostname"

persistence:
  enabled: true
  storageClass: standard
  accessModes:
    - ReadWriteOnce
  size: 1Gi

livenessProbe:
  httpGet:
    path: /status
    port: 8080
  initialDelaySeconds: 30
  periodSeconds: 10
  timeoutSeconds: 5
  failureThreshold: 6

readinessProbe:
  httpGet:
    path: /status
    port: 8080
  initialDelaySeconds: 10
  periodSeconds: 10
  timeoutSeconds: 5
  failureThreshold: 6

env:
  EMQX_NAME: emqx
  EMQX_HOST: 0.0.0.0
  EMQX_NODE_COOKIE: mysecretcookie
